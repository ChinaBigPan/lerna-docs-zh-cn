(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{367:function(s,t,a){"use strict";a.r(t);var e=a(43),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"lerna-import"}},[a("code",[s._v("@lerna/import")])]),s._v(" "),a("blockquote",[a("p",[s._v("将一个包导入到带有提交历史记录的"),a("code",[s._v("monorepo")]),s._v("中")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/lerna/lerna/tree/master/commands/import#readme",target:"_blank",rel:"noopener noreferrer"}},[s._v("英文原地址"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("安装 lerna 以访问"),a("code",[s._v("lerna")]),s._v(" CLI。")]),s._v(" "),a("h2",{attrs:{id:"使用"}},[s._v("使用")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("lerna "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("path-to-external-repository"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("将位于"),a("code",[s._v("<path-to-external-repository>")]),s._v("处的带有提交历史记录的包导入到"),a("code",[s._v("packages/<directory-name>")]),s._v("中。原始提交作者、日期和消息保存了下来。提交应用于当前分支。")]),s._v(" "),a("p",[s._v("这对于将预先存在的独立的包收集到 Lerna 仓库非常有用。每次提交都修改为相对于包目录进行更改。例如，添加"),a("code",[s._v("package.json")]),s._v("的提交将改为添加"),a("code",[s._v("packages/<directory-name>/package.json")]),s._v("。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("如果要在新的 lerna 存储库上导入外部存储库，那么一定要记住至少进行一次提交。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Lerna 起始")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init lerna-repo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" lerna-repo\nnpx lerna init\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交一次")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit -m "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Initial lerna commit"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果没有提交会报错")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 引入其他库")]),s._v("\nnpx lerna "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("path-to-external-repository"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"配置项"}},[s._v("配置项")]),s._v(" "),a("h3",{attrs:{id:"flatten"}},[a("code",[s._v("--flatten")])]),s._v(" "),a("p",[s._v("当导入带有冲突合并提交的存储库时，"),a("code",[s._v("import")]),s._v("命令在尝试应用所有提交时将失败。用户可以使用这个标志来请求“抹平(flat)”历史的导入，也就是说，在每次合并提交时，合并就会被引入。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("lerna "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" ~/Product --flatten\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"dest"}},[a("code",[s._v("--dest")])]),s._v(" "),a("p",[s._v("在导入存储库时，可以根据"),a("code",[s._v("lerna.json")]),s._v("中列出的目录指定目标目录。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("lerna "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" ~/Product --dest"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utilities\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"preserve-commit"}},[a("code",[s._v("--preserve-commit")])]),s._v(" "),a("p",[s._v("每次"),a("code",[s._v("git")]),s._v("提交都有一位"),a("strong",[s._v("作者")]),s._v("和一位"),a("strong",[s._v("提交者")]),s._v("(每人都有一个单独的日期)。通常他们是同一个人(和日期)，但是因为"),a("code",[s._v("lerna import")]),s._v("从外部存储库重新创建每个提交，"),a("strong",[s._v("提交者")]),s._v("就变成了当前的"),a("code",[s._v("git")]),s._v("用户(和日期)。这在技术上是正确的，但可能并不可取，例如，在 Github 上，如果"),a("strong",[s._v("作者")]),s._v("和"),a("strong",[s._v("提交者")]),s._v("是不同的人，它就会同时显示他们，这可能会导致导入提交时的历史/职责出现混乱。")]),s._v(" "),a("p",[s._v("启用该配置项可以保留原始提交者(和提交日期)，以避免此类问题。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("lerna "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" ~/Product --preserve-commit\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);